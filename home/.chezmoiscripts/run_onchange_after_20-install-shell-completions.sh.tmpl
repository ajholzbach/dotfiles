{{- if or (eq .chezmoi.os "darwin") (eq .chezmoi.os "linux") -}}
#!/usr/bin/env bash
set -euo pipefail

XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"

if command -v fish >/dev/null 2>&1; then
    mkdir -p "$XDG_CONFIG_HOME/fish/completions"

    if command -v chezmoi >/dev/null 2>&1; then
        echo "Installing fish completions for chezmoi..."
        chezmoi completion fish --output="$XDG_CONFIG_HOME/fish/completions/chezmoi.fish"
    fi

    if command -v mise >/dev/null 2>&1; then
        echo "Installing fish completions for mise..."
        mise completion fish > "$XDG_CONFIG_HOME/fish/completions/mise.fish"
    fi

    if command -v bat >/dev/null 2>&1; then
        echo "Installing fish completions for bat..."
        bat --completion fish > "$XDG_CONFIG_HOME/fish/completions/bat.fish"
    fi

    if command -v rg >/dev/null 2>&1; then
        echo "Installing fish completions for rg..."
        rg --generate complete-fish > "$XDG_CONFIG_HOME/fish/completions/rg.fish"
    fi

    if command -v fd >/dev/null 2>&1; then
        echo "Installing fish completions for fd..."
        fd --gen-completions fish > "$XDG_CONFIG_HOME/fish/completions/fd.fish"
    fi
fi
{{- end }}
